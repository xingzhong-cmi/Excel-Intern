# Excel Auto Handle - 使用示例

本文档提供了一些实际使用示例，帮助您快速上手。

## 示例文件准备

首先，在 `uploads/` 目录中准备一些测试文件。

### 创建测试数据

使用 Python 快速创建测试文件：

```python
import pandas as pd

# 示例1: 员工数据
employee_data = {
    '姓名': ['张三', '李四', '王五', '张三', '赵六', '孙七'],
    '年龄': [25, 30, 35, 25, 28, 32],
    '部门': ['销售', '技术', '人事', '销售', '财务', '技术'],
    '工资': [5000, 8000, 6000, 5000, 7000, 8500]
}
df = pd.DataFrame(employee_data)
df.to_excel('uploads/employees.xlsx', index=False, sheet_name='员工表')

# 示例2: 销售数据
sales_data = {
    '日期': ['2024-01-01', '2024-01-02', '2024-01-03', '2024-01-04', '2024-01-05'],
    '产品': ['产品A', '产品B', '产品A', '产品C', '产品B'],
    '数量': [10, 5, 8, 12, 6],
    '单价': [100, 200, 100, 150, 200],
    '金额': [1000, 1000, 800, 1800, 1200]
}
df = pd.DataFrame(sales_data)
df.to_excel('uploads/sales.xlsx', index=False, sheet_name='销售记录')

# 示例3: 成绩数据
grades_data = {
    '学号': ['S001', 'S002', 'S003', 'S004', 'S005'],
    '姓名': ['小明', '小红', '小刚', '小丽', '小华'],
    '数学': [85, 92, 78, 95, 88],
    '英语': [90, 85, 80, 92, 86],
    '语文': [88, 90, 85, 90, 92]
}
df = pd.DataFrame(grades_data)
df.to_excel('uploads/grades.xlsx', index=False, sheet_name='成绩单')
```

## 常用操作示例

### 1. 数据去重

**场景**: 员工表中有重复数据，需要按姓名去重

**指令**:
```
对 employees.xlsx 的员工表按姓名列去重
```

**预期结果**: 
- 删除重复的"张三"记录
- 保留4个唯一员工
- 生成 `employees_去重_时间戳.xlsx`

### 2. 数据统计

**场景**: 计算员工总工资和平均工资

**指令**:
```
计算 employees.xlsx 员工表中工资列的总和和平均值
```

**预期结果**:
- 显示工资总和
- 显示平均工资

### 3. 数据筛选

**场景**: 筛选出年龄大于30岁的员工

**指令**:
```
从 employees.xlsx 中筛选年龄大于30的员工
```

或者更复杂的条件：

```
从 sales.xlsx 中筛选金额大于1000的销售记录
```

**预期结果**: 
- 生成包含符合条件数据的新文件

### 4. 数据分组统计

**场景**: 按部门统计平均工资

**指令**:
```
按部门统计 employees.xlsx 中的平均工资
```

**预期结果**:
- 显示各部门的平均工资

### 5. 添加新列

**场景**: 在成绩单中添加总分列

**指令**:
```
在 grades.xlsx 的成绩单中添加总分列，总分为数学、英语、语文三科之和
```

### 6. 删除空行

**场景**: 清理数据中的空行

**指令**:
```
删除 employees.xlsx 中的所有空行
```

### 7. 文件合并

**场景**: 合并多个月份的销售数据

**指令**:
```
纵向合并 sales_jan.xlsx 和 sales_feb.xlsx
```

或者：

```
将 file1.xlsx 和 file2.xlsx 合并成一个文件
```

### 8. 数据查找

**场景**: 查找特定部门的员工

**指令**:
```
查找 employees.xlsx 中部门为技术的所有员工
```

### 9. 计算派生列

**场景**: 在销售表中计算利润（假设利润率30%）

**指令**:
```
在 sales.xlsx 中添加利润列，利润为金额的30%
```

### 10. 数据排序

**场景**: 按工资降序排列员工

**指令**:
```
将 employees.xlsx 按工资从高到低排序
```

## 高级示例

### 多条件筛选

```
从 employees.xlsx 中筛选年龄大于25且工资大于6000的员工
```

### 关联合并

```
将 employees.xlsx 和 departments.xlsx 按部门列关联合并
```

### 数据透视

```
对 sales.xlsx 按产品分组，统计总销量和总金额
```

### 批量处理

```
对 uploads 目录下所有 xlsx 文件删除空行
```

## 提示与技巧

### 1. 明确指定文件和工作表

✅ **好的指令**:
```
对 employees.xlsx 的员工表按姓名去重
```

❌ **模糊的指令**:
```
去重
```

### 2. 清楚说明操作目标

✅ **好的指令**:
```
计算 sales.xlsx 销售记录中金额列的总和
```

❌ **模糊的指令**:
```
统计一下
```

### 3. 复杂操作分步执行

对于复杂的数据处理，建议分步进行：

1. 先筛选数据
2. 再进行计算
3. 最后格式化输出

### 4. 检查结果文件

每次操作后，检查 `results/` 目录中生成的文件，确认结果是否符合预期。

### 5. 查看日志

如遇问题，查看 `logs/` 目录中的日志文件，了解详细的执行过程和错误信息。

### 6. 使用特殊命令

- 输入 `list` 查看当前可用的文件列表
- 输入 `exit` 或 `quit` 退出程序

## 错误处理示例

### 文件名错误

```
指令: 对 test.xlsx 去重
错误: 文件不存在: uploads/test.xlsx
解决: 检查文件是否在 uploads 目录，文件名是否正确
```

### 列名错误

```
指令: 计算 employees.xlsx 中薪资列的总和
错误: 列 '薪资' 不存在
解决: 使用 list 命令查看正确的列名（实际列名是"工资"）
```

### 工作表名错误

```
指令: 对 employees.xlsx 的Sheet1去重
错误: 工作表名错误
解决: 使用正确的工作表名"员工表"
```

## 性能优化建议

1. **大文件处理**: 对于大文件，处理时间会较长，请耐心等待
2. **批量操作**: 尽量一次处理一个文件，避免同时处理多个大文件
3. **指令简化**: 复杂操作可以分解为多个简单操作

## 总结

Excel Auto Handle 通过自然语言理解您的需求，自动生成并执行处理脚本。关键是：

1. ✅ 明确指定文件名和工作表名
2. ✅ 清楚描述要执行的操作
3. ✅ 指定操作的目标列或条件
4. ✅ 检查 results 目录中的输出结果
5. ✅ 遇到问题查看日志文件

祝您使用愉快！
